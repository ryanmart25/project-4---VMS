<!DOCTYPE html>
<html lang="en">
<head>
   <link rel="stylesheet" href="AdminDash_css/style.css">
</head>
<body>
   <div class="side-nav">
      <!-- Sidebar content -->
      <div class="user">
         <img src="AdminDash_images/ProfilePic.png" class="user-img">
         <div>
             <h2>Dylan Prosser</h2>
             <p>dprosser@csus.edu</p>
         </div>
     </div>
     <ul>
         <li><img src = "AdminDash_images/DashBoard.png"><p>Dashboard</p></li>
         <li><img src = "AdminDash_images/Mail.png"><p>Messages</p></li>
         <li><img src = "AdminDash_images/TimeSheet.png"><p>Timesheet</p></li>
         <li><img src = "AdminDash_images/settings.png"><p>Settings</p></li>
     </ul>

     <ul>
         <div class="logo">
             <li><img src = "AdminDash_images/Project4Logo.png" class = "logo-img"></li>
         </div>
     </ul>
   </div>
   <h1 class="heading">Your Events</h1>
   <div class="container">   
      <div class="box-container" id="event-container">
         <!-- Boxes will be dynamically generated here -->
      </div>
      <div id="load-more">Load More</div>
   </div>

   <div class="container"> 
      <div id="load-more">Create Event</div>
   </div>
   
   <hr class="solid">
   <h1 class="heading">Browse Other Events</h1>
   <div class="container">   
      <div class="box-container" id="other-event-container">
         <!-- Boxes will be dynamically generated here -->
      </div>
      <div id="load-more2">Load More</div>
   </div>

   <script>
      function createBoxes(containerId, boxClass, numBoxes) {
         const container = document.getElementById(containerId);
         container.innerHTML = ''; // Clear previous content
         for (let i = 1; i <= numBoxes; i++) {
            const box = document.createElement('div');
            box.className = boxClass;
            box.innerHTML = `
               <div class="content">
                  <h3>Event ${i}</h3>
                  <p>Date: MM/DD/YYYY</p>
                  <p>Time: 00:00AM/PM</p>
                  <p>Location</p>
                  <a href="#" class="btn">view event</a>
               </div>
            `;
            container.appendChild(box);
         }
      }

      let loadMoreBtn = document.querySelector('#load-more');
      let currentItem = 4; // Initialize currentItem
      loadMoreBtn.onclick = () => {
         let boxes = [...document.querySelectorAll('.container .box-container .box')];
         for (var i = currentItem; i < currentItem + 4 && i < boxes.length; i++){
            boxes[i].style.display = 'inline-block';
         }
         currentItem += 4;
      
         if(currentItem >= boxes.length){
            loadMoreBtn.style.display = 'none';
         }
      };

      let loadMoreBtn2 = document.querySelector('#load-more2');
      let currentItem2 = 4; // Initialize currentItem2
      loadMoreBtn2.onclick = () => {
         let boxes2 = [...document.querySelectorAll('.container .box-container .box2')];
         for (var i = currentItem2; i < currentItem2 + 4 && i < boxes2.length; i++){
            boxes2[i].style.display = 'inline-block';
         }
         currentItem2 += 4;
      
         if(currentItem2 >= boxes2.length){
            loadMoreBtn2.style.display = 'none';
         }
      };
      const userId = '661edf0d7583161e07fc1528'; // Assume this is the user's ID

      //Insert Array of Event IDS here, then take the length of the array and pass the number into the create boxes.

      let otherEventIdsArray = []; // Array to store the IDs of other events


      async function fetchOtherEventIds(userId) {
          try {
              const response = await fetch(`http://localhost:8080/api/v1/otherEvents?userid=${userId}`);
              const events = await response.json();
              const ids = events.map(event => event._id);
              otherEventIdsArray = [...otherEventIdsArray, ...ids]; // Append fetched IDs to the array
              return ids; // Return just the IDs fetched in this call
          } catch (error) {
              console.error('Error fetching other event IDs:', error);
              return []; // Return an empty array in case of error
          }
      }

      // Call this function to obtain IDs of other events

      fetchOtherEventIds(userId)
          .then(eventIds => {
              console.log("Other Event IDs:", otherEventIdsArray); // Log the updated array of other event IDs
          });



      // Used to test the dynamic boxes
      const numEvents = prompt("Enter the number of events:");
      createBoxes('event-container', 'box', parseInt(numEvents));
      const numOtherEvents = otherEventIdsArray.length;
      createBoxes('other-event-container', 'box2', parseInt(numOtherEvents));
   </script>






</body>
</html>